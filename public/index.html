<html>
<head>
<script src="/bower_components/angular/angular.min.js"></script>
<script src="/bower_components/angular-route/angular-route.js"></script>
<script src="/bower_components/angular-local-storage.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script type="text/javascript">
	var app = angular
		.module("Example",['ngRoute', 'LocalStorageModule'])
			.config(function($routeProvider){
        		$routeProvider
                .when("/", {
                    templateUrl : "views/glavnaya.html",
                    
                })
	            .when("/CreateGroup", {
	                templateUrl : "views/CreateGroup.html",
	                controller : "addGroupController"
	            })
                .when("/CreateStudent", {
                    templateUrl : "views/CreateStudent.html",
                    controller : "studentController",
                })
                .when("/CreateTeacher", {
                    templateUrl : "views/CreateTeacher.html",
                    controller : "teacherController"
                })
                .when("/group", {
                    templateUrl : "views/group.html",
                    controller : "groupController"
                })
                .when("/CreateUsluga",{
                    templateUrl:"views/CreateUsluga.html",
                    controller: "addUslugaController"
                })
                .when("/CreatePatient", {
                    templateUrl:"views/CreatePatient.html",
                    controller:"addPatientController"
                })
                .when("/CreateDoctor",{
                    templateUrl:"views/CreateDoctor.html",
                    controller:"addDoctorController"
                })
    		})
    		.config(function (localStorageServiceProvider) {
    			localStorageServiceProvider
    				.setPrefix('Test')
    				.setStorageType('sessionStorage')
    				.setNotify(true, true)
    		})
    		.controller("mainController", function($scope, $location, localStorageService) {
                $scope.groupInfo;
    			$scope.goTo = function(url) {
    				$location.path(url);
    			}
                $scope.goToGroup = function(url, group) {
                    $location.path(url);
                    $scope.groupInfo = group;
                }
                if (localStorageService.get("message") != null) {
                    $scope.groups = localStorageService.get("message");
                } else {
                    $scope.groups = [];
                    localStorageService.set("message", $scope.groups)
                }
                 if (localStorageService.get("message1") != null) {
                    $scope.uslugi = localStorageService.get("message1");
                } else {
                    $scope.uslugi = [];
                    localStorageService.set("message1", $scope.uslugi)
                }
                 if (localStorageService.get("message2") != null) {
                    $scope.doctors = localStorageService.get("message2");
                } else {
                    $scope.doctors = [];
                    localStorageService.set("message2", $scope.doctors)
                }
                if (localStorageService.get("message3") != null) {
                    $scope.patienty = localStorageService.get("message3");
                } else {
                    $scope.patienty = [];
                    localStorageService.set("message3", $scope.patienty)
                }
                
    		})
            .controller("addGroupController", function($scope, localStorageService) {
                var self = $scope;
                var groups = localStorageService.get("message");
                function GroupClass(name, code, teacher, students)
                {
                    this.name = name;
                    this.code = code;
                    this.teacher = teacher;
                    this.students = students;
                    
                }
                self.CreateGroup = function() {
                    var group = new GroupClass(self.group.name, self.group.code, "", []);
                    groups.push(group);
                    localStorageService.set("message", groups);
                    //console.log(localStorageService.get("message"))
                }
            })
            .controller("addUslugaController", function($scope, localStorageService) {
                var self = $scope;
                var uslugi = localStorageService.get("message1");
                function UslugaClass(name)
                {
                    this.name = name;  
                }
                self.CreateUsluga = function() {
                    var usluga = new UslugaClass(self.usluga.name);
                    uslugi.push(usluga);
                    localStorageService.set("message1", uslugi);
                    //console.log(localStorageService.get("message"))
                }
                $scope.deleteUsluga = function(index){ 
                $scope.uslugi.splice(index, 1); 
                localStorageService.set("message1", $scope.uslugi);}
                $scope.uslugaInfo;
                $scope.goFor = function(url) {
                    $location.path(url);
                }
                $scope.goToUsluga = function(url, usluga){
                    $location.path(url);
                    $scope.uslugaInfo = usluga;
                }
               
            })
            .controller("addPatientController", function($scope, localStorageService) {
                var self = $scope;
                var patienty = localStorageService.get("message3");
                function PatientClass(name, surname, phone)
                {
                    this.name = name;  
                    this.surname = surname;
                    this.phone = phone;
                }
                self.CreatePatient = function() {
                    var patient = new PatientClass(self.patient.name, self.patient.surname, self.patient.phone);
                    patienty.push(patient);
                    localStorageService.set("message3", patienty);
                    //console.log(localStorageService.get("message"))
                }
                 $scope.deletePatient = function(index){ 
                $scope.patienty.splice(index, 1); 
                localStorageService.set("message3", $scope.patienty);}
                 $scope.patientInfo;
                $scope.goFor = function(url) {
                    $location.path(url);
                }
                $scope.goToPatient = function(url, patient){
                    $location.path(url);
                    $scope.patientInfo = patient;
                }
            })
            .controller("addDoctorController", function($scope, localStorageService) {
                var self = $scope;
                var doctors = localStorageService.get("message2");
                function DoctorClass(name, surname, speciality)
                {
                    this.name = name;  
                    this.surname = surname;
                    this.speciality = speciality;
                }
                self.CreateDoctor = function() {
                    var doctor = new DoctorClass(self.doctor.name, self.doctor.surname, self.doctor.speciality);
                    doctors.push(doctor);
                    localStorageService.set("message2", doctors);
                    //console.log(localStorageService.get("message"))
                }
                $scope.doctorInfo;
                $scope.goFor = function(url) {
                    $location.path(url);
                }
                $scope.goToDoctor = function(url, doctor){
                    $location.path(url);
                    $scope.doctorInfo = doctor;
                }
            })
            .controller("studentController", function($scope, localStorageService) {
                var self = $scope;
                var group;
                var usluga;
                // var usligi = localStorageService.get("message1");
                var groups = localStorageService.get("message");
                function StudentClass(name, surname, GPA, cource)
                {
                    this.name = name;
                    this.surname = surname;
                    this.GPA = GPA;
                    this.cource = cource;

                    this.GetGPA = function()
                    {
                        return this.GPA;
                    }
                    this.GetCource = function()
                    {
                        return this.cource;
                    }
                }
                self.pickGroup = function(pGroup) {
                    group = pGroup;
                    console.log(group);
                }
                self.pickUsluga = function(pUsluga) {
                    usluga = pUsluga;
                    console.log(usluga);
                }

                self.CreateStudent = function() {
                    var student = new StudentClass(self.student.name, self.student.surname, self.student.GPA, self.student.cource);
                    for (var i = 0; i < groups.length; i++) {
                        if (groups[i].name == group.name) {
                            group.students.push(student);
                            groups[i] = group;
                            localStorageService.set("message", groups);
                            //console.log(localStorageService.get("message"))
                        }
                    }
                }
            })
            
            .controller("groupController", function($scope) {
                var self = $scope;
                self.students = self.groupInfo.students;
                self.teacher = self.groupInfo.teacher;
            })
            .controller('ExampleController', function($scope,localStorageService) {
               // $scope.patienty = localStorageService.get("message3");
                $scope.uslugi =  localStorageService.get("message1");

                      // $scope.data = {
                      //  model: null,
                      //   availableOptions: [
                      //   {id: '1', name: 'Option A'},
                      //   {id: '2', name: 'Option B'},
                      //   {id: '3', name: 'Option C'}
                      //     ]
                      //   };
                    })

</script>
 <style>
    body {
        background: #f1f1f1 url(images/1.jpg) no-repeat center fixed; /* Фоновый цвет и фоновый рисунок*/
        color: #767676; /*Цвет текста на странице*/
        background-attachment: fixed; /* Фон страницы фиксируется */
        background-repeat: repeat-x; /* Изображение повторяется по горизонтали */
    }
   </style>
</head>

<body ng-app="Example">
	<div ng-controller="mainController">
        <button ng-click="goTo('')">Главная</button>
        <button ng-click="goTo('/CreateStudent')">Добавить прием</button>
        <button ng-click="goTo('/CreateUsluga')">Добавить Услугу</button>
        <button ng-click="goTo('/CreatePatient')">Добавить Пациента</button>
        <button ng-click="goTo('/CreateDoctor')">Добавить Врача</button>
		<div ng-repeat="group in groups" ng-click="goToGroup('/group', group)">{{group.name}}</div>
        
		<div ng-view>

		</div>
	</div>
</body>
</html>